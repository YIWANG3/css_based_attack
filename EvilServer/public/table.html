<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Table</title>
    <style>
        table {
            margin: 0 auto;
            border-collapse: collapse;
        }

        td {
            width: 20px;
            height: 20px;
        }
    </style>
    <script src="js/socket.io.js"></script>
</head>
<body>
<script>
    function tableCreate(row_num, col_num) {
        //body reference
        var body = document.getElementsByTagName("body")[0];

        // create elements <table> and a <tbody>
        var tbl = document.createElement("table");
        var tblBody = document.createElement("tbody");

        let count = 0;
        // cells creation
        for (var j = 0; j <= row_num; j++) {
            // table row creation
            var row = document.createElement("tr");

            for (var i = 0; i < col_num; i++) {
                // create element <td> and text node
                //Make text node the contents of <td> element
                // put <td> at end of the table row
                var cell = document.createElement("td");
                cell.id = `t-${count}`;
                count++;
                row.appendChild(cell);
            }

            //row added to end of table body
            tblBody.appendChild(row);
        }

        // append the <tbody> inside the <table>
        tbl.appendChild(tblBody);
        // put <table> in the <body>
        body.appendChild(tbl);
        // tbl border attribute to
        tbl.setAttribute("border", "1");
    }

    window.onload = () => {
        tableCreate(30, 30);

        const socket = io();
        socket.on("UPDATE", (data) => {
            if (data.site && data.site === "table") {
                let targetDom = document.querySelector(data.payload);
                targetDom.style.backgroundColor = "black";
            }
        })
    };
</script>

</body>
</html>
